<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Valerio Gherardi">
<meta name="dcterms.date" content="2024-06-25">
<meta name="description" content="A seminal article with enlightening views on the logical structure of Thermodynamics.">

<title>“The Physics and Mathematics of the Second Law of Thermodynamics” by E.H. Lieb and J. Yngvason – vgherard</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BM2Y0430QE"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-BM2Y0430QE', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">vgherard</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notebooks.html"> 
<span class="menu-text">Notebooks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../scientific_publications.html"> 
<span class="menu-text">Scientific Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../files.html"> 
<span class="menu-text">Files</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vgherard"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/vgherard/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ValerioGherardi"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:vgherard840@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://raw.githubusercontent.com/vgherard/cv/master/cv/cv.pdf"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-other-links" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Other links</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-other-links">    
        <li>
    <a class="dropdown-item" href="https://www.r-bloggers.com/author/vgherard/">
 <span class="dropdown-text">vgherard @ r-bloggers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://stackexchange.com/users/2261006/pppqqq">
 <span class="dropdown-text">vgherard @ StackExchange</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://inspirehep.net/authors/1728353?ui-citation-summary=true">
 <span class="dropdown-text">vgherard @ iNSPIRE HEP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://lichess.org/@/vgherard">
 <span class="dropdown-text">vgherard @ lichess.org</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://ratings.fide.com/profile/94715360">
 <span class="dropdown-text">vgherard @ FIDE</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">“The Physics and Mathematics of the Second Law of Thermodynamics” by E.H. Lieb and J. Yngvason</h1>
                  <div>
        <div class="description">
          <p>A seminal article with enlightening views on the logical structure of Thermodynamics.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Comment on…</div>
                <div class="quarto-category">Thermodynamics</div>
                <div class="quarto-category">Physics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://vgherard.github.io">Valerio Gherardi</a> <a href="https://orcid.org/0000-0002-8215-3013" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 25, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#formal-framework" id="toc-formal-framework" class="nav-link active" data-scroll-target="#formal-framework">Formal framework</a></li>
  <li><a href="#axioms-of-adiabatic-accessibility" id="toc-axioms-of-adiabatic-accessibility" class="nav-link" data-scroll-target="#axioms-of-adiabatic-accessibility">Axioms of adiabatic accessibility</a></li>
  <li><a href="#existence-and-uniqueness-of-entropy" id="toc-existence-and-uniqueness-of-entropy" class="nav-link" data-scroll-target="#existence-and-uniqueness-of-entropy">Existence and uniqueness of entropy</a></li>
  <li><a href="#convexity" id="toc-convexity" class="nav-link" data-scroll-target="#convexity">Convexity</a></li>
  <li><a href="#simple-systems" id="toc-simple-systems" class="nav-link" data-scroll-target="#simple-systems">Simple systems</a></li>
  <li><a href="#thermal-equilibrium" id="toc-thermal-equilibrium" class="nav-link" data-scroll-target="#thermal-equilibrium">Thermal Equilibrium</a></li>
  <li><a href="#temperature" id="toc-temperature" class="nav-link" data-scroll-target="#temperature">Temperature</a></li>
  <li><a href="#chemical-mixtures-and-reactions" id="toc-chemical-mixtures-and-reactions" class="nav-link" data-scroll-target="#chemical-mixtures-and-reactions">Chemical mixtures and reactions</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<form method="post" action="https://blogtrottr.com">
        <p> Enjoy my blog? Get notified of new posts via email: </p>
    <input type="text" name="btr_email" placeholder="your@email.here"><br>
    <input type="hidden" name="btr_url" value="https://vgherard.github.io/index.xml">
    <input type="hidden" name="schedule_type" value="0">
    <input type="submit" value="Subscribe">
</form>
or
<a href="https://vgherard.github.io/index.xml"> subscribe to its RSS feed</a>.
<br>
<br>
R-related posts also available at
<a href="https://www.r-bloggers.com">r-bloggers</a> and <a href="https://rweekly.org/">RWeekly</a>.

</div></div>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><span class="citation" data-cites="LY1">(<a href="#ref-LY1" role="doc-biblioref">Lieb and Yngvason 1999</a>)</span>.</p>
<blockquote class="blockquote">
<p>The essential postulates of classical thermodynamics are formulated, from which the second law is deduced as the principle of increase of entropy in irreversible adiabatic processes that take one equilibrium state to another. The entropy constructed here is defined only for equilibrium states and no attempt is made to define it otherwise. Statistical mechanics does not enter these considerations. One of the main concepts that makes everything work is the comparison principle (which, in essence, states that given any two states of the same chemical composition at least one is adiabatically accessible from the other) and we show that it can be derived from some assumptions about the pressure and thermal equilibrium. Temperature is derived from entropy, but at the start not even the concept of ‘hotness’ is assumed. Our formulation offers a certain clarity and rigor that goes beyond most textbook discussions of the second law.</p>
</blockquote>
<p>The paper can be subdivided into two parts. In the first part, the authors deduce the existence of a universal entropy state function from a primitive notion of adiabatic accessibility. A key assumption in this derivation is the so-called Comparison Hypothesis, that postulates that for any two equilibrium states <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> of a given thermodynamic system, either <span class="math inline">\(X\)</span> is adiabatically accessible from <span class="math inline">\(Y\)</span> or <span class="math inline">\(Y\)</span> is adiabatically accessible from <span class="math inline">\(X\)</span>.</p>
<p>The second part is devoted to the derivation of the Comparison Hypothesis (which becomes thus a Comparison <em>Principle</em>) for an important class of thermodynamic systems. The main ingredients for this derivation are: - The First Law of Thermodynamics and, in particular the concept of internal energy. - The notion of thermal equilibrium and its transitivity (sometimes called the “Zero-th Law”). - An assumed convex structure in the state space of thermodynamic systems.</p>
<p>So, how does such a formal endeavor improve our understanding of Nature? On one side, entropy is clarified to represent nothing more than a numerical encoding of adiabatic accessibility. Its existence is independent of the concepts of energy, heat or temperature that appear in the usual formulations of Thermodynamics. On the other side, the classical statements of the Second Law of Kelvin-Planck and Clausius, which are explicitly formulated in terms of heat and temperature, are seen to be <em>theorems</em> on the adiabatic (in)accessibility of certain states, that follow from how the concepts of internal energy and thermal equilibrium interact with the primitive notion of adiabatic accessibility. Both of these are major advancements, because they clarify the physical content and universality of the Second Law of Thermodynamics.</p>
<p>The last Section of <span class="citation" data-cites="LY1">(<a href="#ref-LY1" role="doc-biblioref">Lieb and Yngvason 1999</a>)</span> provides a useful summary of the formalism and of the logical paths followed by the mathematical derivations. The rest of this post are some personal notes on the original reference.</p>
<section id="formal-framework" class="level3">
<h3 class="anchored" data-anchor-id="formal-framework">Formal framework</h3>
<p>Systems are described as collections of thermodynamic states, with two binary operations that have the operative interpretations of “composition” (of non-interacting systems) and “scaling”, respectively. In detail:</p>
<ul>
<li><p><strong>Systems.</strong> A <em>system</em> is just a set <span class="math inline">\(\Gamma\)</span>, whose elements correspond to physical (thermodynamic) states.</p></li>
<li><p><strong>Composition.</strong> A binary operation that takes as input two thermodynamic states <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> of two systems <span class="math inline">\(\Gamma _1\)</span> and <span class="math inline">\(\Gamma _2\)</span>, and returns a new state <span class="math inline">\(X_1 \oplus X_2 \in \Gamma _1 \oplus \Gamma _2\)</span>, where the latter set can be informally thought as the Cartesian product <span class="math inline">\(\Gamma _1 \times \Gamma _2\)</span>. Since the ordering in the enumeration of systems is inconsequential from the physical point of view, we assume that compositions are equipped with an equivalence relation <span class="math inline">\(\stackrel{\oplus}{\sim}\)</span>, such that <span class="math inline">\(X_1 \oplus X_2 \stackrel{\oplus}{\sim} X_2 \oplus X_1\)</span> and that <span class="math inline">\((X_1 \oplus X_2)\oplus X_3 \stackrel{\oplus}{\sim} X_1 \oplus (X_2\oplus X_3)\)</span>.</p></li>
<li><p><strong>Scaling.</strong> A binary operation that takes as input a positive number <span class="math inline">\(\lambda\)</span> and a thermodynamic state <span class="math inline">\(X\in \Gamma\)</span>, and returns a new state $X $ as output. The operation is assumed to satisfy <span class="math inline">\(t(sX) = (ts)X\)</span>, as well as <span class="math inline">\(t(X_1\oplus X_2)=(tX_1) \oplus (tX_2)\)</span>.</p></li>
</ul>
<p>Some care is needed in the operative interpretation of the scaling operation for systems that are not scale invariant, such as a droplet of liquid with a non-negligible surface energy. This particular example is discussed in detail by the authors in Sec. 3.1, in connection with simple systems. In short, for such systems we should interpret the state space as a submanifold of an extended state space corresponding to a scale invariant system. It is for this latter system that the axioms of <span class="citation" data-cites="LY1">(<a href="#ref-LY1" role="doc-biblioref">Lieb and Yngvason 1999</a>)</span> are assumed to hold.</p>
</section>
<section id="axioms-of-adiabatic-accessibility" class="level3">
<h3 class="anchored" data-anchor-id="axioms-of-adiabatic-accessibility">Axioms of adiabatic accessibility</h3>
<p>A central notion in <span class="citation" data-cites="LY1">(<a href="#ref-LY1" role="doc-biblioref">Lieb and Yngvason 1999</a>)</span> is that of <em>adiabatic accessibility</em>. From the operative point of view this corresponds to the possibility of transforming a thermodynamic state into another without supplying heat to the system. Mathematically, adiabatic accessibility is a relation <span class="math inline">\(\prec\)</span> on the set of all thermodynamic states that satisfies (among other things) the axioms of a pre-order: reflexivity and transitivity.</p>
<p>More in detail, <span class="math inline">\(\prec\)</span> is assumed to satisfy the following axioms:</p>
<ul>
<li><strong>(A1) Reflexivity</strong>. <span class="math inline">\(X \prec X\)</span> for any <span class="math inline">\(X\)</span>.</li>
<li><strong>(A2) Transitivity</strong>. <span class="math inline">\(X\prec Y\)</span> and <span class="math inline">\(Y \prec Z\)</span> implies <span class="math inline">\(X \prec Z\)</span> for all <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span>.</li>
<li><strong>(A3) Consistency</strong>. <span class="math inline">\(X\prec Y\)</span> and <span class="math inline">\(X^\prime \prec Y ^\prime\)</span> implies <span class="math inline">\(X\oplus X^\prime \prec Y \oplus Y^\prime\)</span> for all <span class="math inline">\(X\)</span>, <span class="math inline">\(X^\prime\)</span>, <span class="math inline">\(Y\)</span> and <span class="math inline">\(Y^\prime\)</span></li>
<li><strong>(A4) Scaling invariance</strong>. <span class="math inline">\(X\prec Y\)</span> implies <span class="math inline">\(\lambda X \prec \lambda Y\)</span> for all <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span> and <span class="math inline">\(\lambda &gt;0\)</span>.</li>
<li><strong>(A5) Splitting and recombination</strong>. <span class="math inline">\(X \prec (\lambda X,(1-\lambda)X) \prec X\)</span> for all <span class="math inline">\(X\)</span> and <span class="math inline">\(0&lt;\lambda &lt;1\)</span>.</li>
<li><strong>(A6) Stability</strong>: if <span class="math display">\[
(X,\varepsilon _n Z) \prec (Y,\varepsilon_n W)
\]</span> holds for some sequence <span class="math inline">\(\varepsilon _n \to 0\)</span>, then <span class="math inline">\(X \prec Z\)</span>.</li>
</ul>
</section>
<section id="existence-and-uniqueness-of-entropy" class="level3">
<h3 class="anchored" data-anchor-id="existence-and-uniqueness-of-entropy">Existence and uniqueness of entropy</h3>
<p>The first part of <span class="citation" data-cites="LY1">(<a href="#ref-LY1" role="doc-biblioref">Lieb and Yngvason 1999</a>)</span> is concerned with the existence and uniqueness of the entropy function. The authors prove that, under axioms A1-A6 characterizing adiabatic accessibility, the two following conditions are equivalent:</p>
<ul>
<li><em>(i)</em> Given states <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span> of a system <span class="math inline">\(\Gamma\)</span> and positive numbers <span class="math inline">\(\lambda _i\)</span> for <span class="math inline">\(i = 1,\,2,\,\dots,\,n\)</span>, the two states <span class="math inline">\(X = \lambda_1 X_1 \oplus \lambda_2 X_2 \oplus \cdots \oplus \lambda _n X_n\)</span> and <span class="math inline">\(Y = \lambda_1 Y_1 \oplus \lambda_2 Y_2 \oplus \cdots \oplus \lambda _n Y_n\)</span> are always comparable, in the sense that either <span class="math inline">\(X\prec Y\)</span> or <span class="math inline">\(Y \prec X\)</span>. This is expressed by saying that “the comparison hypothesis holds on multiple scaled copies of <span class="math inline">\(\Gamma\)</span>”.</li>
<li><em>(ii)</em> There exists a function <span class="math inline">\(S_\Gamma \colon \Gamma \to \mathbb R\)</span> with the following property: if <span class="math inline">\(X = \lambda_1 X_1 \oplus \lambda_2 X_2 \oplus \cdots \oplus \lambda _n X_n\)</span> and <span class="math inline">\(Y = \gamma_1 Y_1 \oplus \gamma_2 Y_2 \oplus \cdots \oplus \gamma _m Y_m\)</span>, where <span class="math inline">\(\sum _{i=1}^n \lambda _i = \sum _{j=1}^m \gamma _j\)</span>, we have <span class="math inline">\(X\prec Y\)</span> if and only if<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>:</li>
</ul>
<p><span class="math display">\[
\sum _{i=1}^n \lambda _iS(X_i)\leq \sum _{i=1}^m \gamma _iS(Y_i).
\]</span> Furthermore, the function <span class="math inline">\(S\)</span> is given by <span class="math inline">\(S = a S^* + b\)</span> for some constants <span class="math inline">\(a,b\)</span> with <span class="math inline">\(a&gt;0\)</span>, where<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>:</p>
<p><span class="math display">\[
S^*(X) = \sup \{\lambda \colon (1-\lambda)X_0\oplus \lambda X_1 \prec X\}
\]</span> where <span class="math inline">\(X_{0,1}\in \Gamma\)</span> are two reference states such that <span class="math inline">\(X_0 \prec X_1\)</span> but the reverse does not hold (the definition enforces <span class="math inline">\(S^*(X_0)=0\)</span> and <span class="math inline">\(S^*(X_1) = 1\)</span>).</p>
</section>
<section id="convexity" class="level3">
<h3 class="anchored" data-anchor-id="convexity">Convexity</h3>
<ul>
<li><strong>(A7) Convex combination</strong>. The space <span class="math inline">\(\Gamma\)</span> is a locally convex subset of a vector space, meaning that <span class="math inline">\(tX + (1-t)Y \in \Gamma\)</span> for all <span class="math inline">\(X,Y\in \Gamma\)</span> and <span class="math inline">\(0&lt;t&lt;1\)</span>. Furthermore, we have that <span class="math inline">\(t X \oplus (1-t)Y\prec t X + (1-t)Y\)</span>.</li>
</ul>
<p>It is easily seen that if an entropy function (in the sense of the previous section) exists, then the second part of the previous axiom (involving <span class="math inline">\(\prec\)</span>) is equivalent to the requirement that entropy is a concave function, <em>i.e.</em> <span class="math inline">\(S(t X + (1-t)Y)\geq tS(X)+(1-t)S(Y)=S(tX\oplus(1-t)Y)\)</span>.</p>
<p>The convex combination of states is most easily interpreted for simple systems (see below), and corresponds to a state in which energy and work coordinates take the intermediate values <span class="math inline">\(t\xi(X)+(1-t)\xi(Y)\)</span>. The possibility of forming convex combinations of states and their adiabatic accessibility is quite obvious for systems such as gas or liquids. For example, suppose we are given <span class="math inline">\(n_i\)</span> moles of gas with energies <span class="math inline">\(n_iU_i\)</span> and volumes <span class="math inline">\(n_iV_i\)</span>, where <span class="math inline">\(n_1 + n_2 = 1\)</span>, and the two gases are separated by a rigid, adiabatic wall. The convex combination is the state of 1 mole of gas that is produced by simply removing the barrier. For solids or more complicated systems, the axiom looks much more questionable, but can be at least experimentally tested for any given system, by exploiting its equivalence with the concavity of entropy.</p>
</section>
<section id="simple-systems" class="level3">
<h3 class="anchored" data-anchor-id="simple-systems">Simple systems</h3>
<p>The discussion moves on to concrete systems whose state space is assumed to be an open convex subset of <span class="math inline">\(\mathbb R^{n+1}\)</span> for some <span class="math inline">\(n&gt;0\)</span>, in agreement with A7. The points of these systems are denoted by pairs <span class="math inline">\((U,V)\)</span>, where <span class="math inline">\(U\in \mathbb R\)</span> and <span class="math inline">\(V \in \mathbb R ^n\)</span> have the physical interpretation of energy and extensive work coordinates, respectively. The possibility of a parametrization with internal energy as one coordinate is the content of the First Law of Thermodynamics.</p>
<p>Simple systems are characterized by the following axioms (the separation of S2 into S2a and S2b is mine):</p>
<ul>
<li><strong>(S1) Irreversibility</strong>. For each <span class="math inline">\(X\)</span> there is a point <span class="math inline">\(Y\)</span> such that <span class="math inline">\(X\prec Y\)</span>. (This axiom is actually implied by the stronger axiom T4, see below.)</li>
<li><strong>(S2a) Tangent Plane</strong>. For each <span class="math inline">\(X\)</span>, the forward sector <span class="math inline">\(A_X=\{Y\in \Gamma\colon X\prec Y\}\)</span> has a unique tangent plane parametrized by an equation of the form:</li>
</ul>
<p><span class="math display">\[
U-U(X)+\sum _{i=1}^n p_i(X)\cdot(V_i-V_i(X))=0
\]</span> - <strong>(S2b) Lipschitz Continuity.</strong> The functions <span class="math inline">\(p_i\)</span> in the previous axiom are locally Lipschitz continuous functions. - <strong>(S3) Connectedness of the boundary.</strong> The boundary of any forward sector is connected.</p>
<p>Using only axioms <strong>(S1)</strong> and <strong>(S2a)</strong>, the Kelvin-Planck statement of the Second Law of Thermodynamics can be proved, namely:</p>
<blockquote class="blockquote">
<p>No process is possible, the sole result of which is a change in the energy of a simple system (without changing the work coordinates) and the raising of a weight.</p>
</blockquote>
<p>Including also <strong>(S2b)</strong> and <strong>(S3)</strong>, the main theorem of this section can be proved, stating that <em>any two states of a simple system are comparable</em>.</p>
</section>
<section id="thermal-equilibrium" class="level3">
<h3 class="anchored" data-anchor-id="thermal-equilibrium">Thermal Equilibrium</h3>
<ul>
<li><p><strong>(T1) Thermal Contact</strong>. For any two simple systems. For any two simple systems with state spaces <span class="math inline">\(\Gamma _1\)</span> and <span class="math inline">\(\Gamma _2\)</span>, there is another simple system, the <em>thermal join</em> of <span class="math inline">\(\Gamma _1\)</span> and <span class="math inline">\(\Gamma _2\)</span>, with state space: <span class="math display">\[
\Gamma_1 \stackrel{T}{\oplus}\Gamma_2 \equiv \{(U_1+U_2,V_1,V_2)\,\colon (U_i,V_i)\in\Gamma_i\},
\]</span> whose states satisfy: <span class="math display">\[
\Gamma_1\oplus\Gamma_2\ni(U_1,V_1)\oplus(U_2,V_2) \prec (U_1+U_2,V_1,V_2)\in \Gamma_1 \stackrel{T}{\oplus}\Gamma_2.
\]</span></p></li>
<li><p><strong>(T2) Thermal Splitting</strong>. For any state of the thermal join <span class="math inline">\((U,V_1,V_2)\in \Gamma_1\stackrel{T}{\oplus}\Gamma_2\)</span> there exist states <span class="math inline">\((U_i,V_i)\in \Gamma _i\)</span> such that <span class="math inline">\(U_1 + U_2 =U\)</span> and: <span class="math display">\[
(U,V_1,V_2) \prec (U_1,V_1) \oplus (U_2,V_2).
\]</span> In particular, if <span class="math inline">\((U,V)\in \Gamma\)</span> is a state of a simple system and <span class="math inline">\(\lambda \in (0,1)\)</span>, we have: <span class="math display">\[
(U,\lambda V,(1-\lambda)V)\prec\lambda(U,V) \oplus (1-\lambda)(U,V)
\]</span> The right-hand side here is an element of <span class="math inline">\(\lambda \Gamma \oplus (1-\lambda) \Gamma\)</span>, while the left hand side is an element of the thermal join of scaled copies <span class="math inline">\(\lambda \Gamma \stackrel{T}{\oplus} (1-\lambda) \Gamma\)</span>.</p></li>
<li><p><strong>(T3) Zero-th law</strong>. The relation <span class="math inline">\(\stackrel{T}{\sim}\)</span> defined in the following is an equivalence relation: <span class="math inline">\(\Gamma _1 \ni(U_1,V_1)\stackrel{T}{\sim}(U_2,V_2)\in \Gamma _2\)</span> if <span class="math inline">\((U_1 + U_2, V_1, V_2) \prec (U_1,V_1) \oplus (U_2,V_2)\)</span>.</p></li>
<li><p><strong>(T4) Transversality</strong>. If <span class="math inline">\(\Gamma\)</span> is a simple system and <span class="math inline">\(X\in \Gamma\)</span>, there exist <span class="math inline">\(X_0,X_1\in \Gamma\)</span> such that <span class="math inline">\(X_0 \prec \prec X \prec \prec X_1\)</span> and <span class="math inline">\(X_0 \stackrel{T}{\sim} X_1\)</span>.</p></li>
<li><p><strong>(T5) Universal temperature range</strong>. If <span class="math inline">\(\Gamma _1\)</span> and <span class="math inline">\(\Gamma _2\)</span> are simple systems, and <span class="math inline">\(V_1\)</span> is in the projection of <span class="math inline">\(\Gamma _1\)</span> onto its work coordinates, for every <span class="math inline">\(X_2 \in \Gamma _2\)</span> there is a <span class="math inline">\(U_1\)</span> such that <span class="math inline">\((U_1,V_1) \stackrel{T}{\sim} X_2\)</span></p></li>
</ul>
<p>The main result from these additional axioms is <em>comparability in the product spaces of simple systems</em>. Also, thermal equilibrium is found to be characterized by maximum entropy, in the sense that if <span class="math inline">\((U_i,V_i)\in \Gamma _i\)</span> are states of simple systems with (consistent) entropies <span class="math inline">\(S_i\)</span> respectively, then:</p>
<p><span class="math display">\[
(U_1,V_1)\stackrel{T}{\sim} (U_2,V_2) \iff S_1+S_2=\max_{U_1^\prime +U_2^\prime=U_1+U_2}\{S(U_1^\prime,V_1)+S(U_2 ^\prime ,V_2)\}.
\]</span></p>
<p>If (T3) is assumed, and if we postulate that for each state <span class="math inline">\(X\)</span> there is at least one state in thermal equilibrium with it - which is guaranteed by (T5) - then the second part of (T2) is equivalent to scaling invariance <span class="math inline">\(\stackrel{T}{\sim}\)</span>. In fact, transitivity and symmetry of <span class="math inline">\(\stackrel{T}{\sim}\)</span> implies <span class="math inline">\(X\stackrel{T}{\sim}X\)</span> for any <span class="math inline">\(X\)</span>. Then the second part of (T2) is equivalent to <span class="math inline">\(t X \stackrel{T}{\sim}(1-t)X\)</span> for any <span class="math inline">\(t \in (0,1)\)</span> and any <span class="math inline">\(X\)</span>, which is in turn equivalent to <span class="math inline">\(\lambda Y \sim Y\)</span> for any <span class="math inline">\(Y\)</span> and <span class="math inline">\(\lambda &gt;0\)</span>.</p>
</section>
<section id="temperature" class="level3">
<h3 class="anchored" data-anchor-id="temperature">Temperature</h3>
<p>Temperature is a derived concept in the formalism of <span class="citation" data-cites="LY1">(<a href="#ref-LY1" role="doc-biblioref">Lieb and Yngvason 1999</a>)</span>, by means of the usual bridge law <span class="math inline">\(T = \left(\frac{\partial U}{\partial S}\right)_V\)</span>. The differentiability of entropy is shown to be a consequence of the axioms stated so far.</p>
<p>Using the derived concept of temperature, the authors prove the Clausius inequality for a Carnot cycle:</p>
<p><span class="math display">\[
\frac{\delta Q_1}{T_1}+\frac{\delta Q_2}{T_2} \leq0,
\]</span> where <span class="math inline">\(T_1\)</span> and <span class="math inline">\(T_2\)</span> are the <em>final</em> temperatures of the reservoirs, that do not need to be assumed of infinite mass.</p>
</section>
<section id="chemical-mixtures-and-reactions" class="level3">
<h3 class="anchored" data-anchor-id="chemical-mixtures-and-reactions">Chemical mixtures and reactions</h3>
<p>The last result of the paper concerns thermodynamic processes that connect states of different systems. The notion of connection of state spaces is introduced: two state spaces <span class="math inline">\(\Gamma\)</span> and <span class="math inline">\(\Gamma ^\prime\)</span> are said to be connected if there are state spaces <span class="math inline">\(\Gamma _0,\,\Gamma_1,\,\dots,\Gamma_N\)</span> and states <span class="math inline">\(X_i,Y_i \in \Gamma _i\)</span>, and <span class="math inline">\(X\in \Gamma\)</span> and <span class="math inline">\(Y\in \Gamma ^\prime\)</span>, such that:</p>
<p><span class="math display">\[
(X,\,X_0) \prec Y_1, \quad X_i ≺ Y_{i+1} \ (i = 1,...,N − 1), \quad X_N \prec (Y ,\,Y_0).
\]</span> If <span class="math inline">\(\Gamma\)</span> is connected to <span class="math inline">\(\Gamma ^\prime\)</span> we write <span class="math inline">\(\Gamma \prec \Gamma ^\prime\)</span>. The last axiom is:</p>
<ul>
<li><strong>(M) Absence of sinks</strong>. <span class="math inline">\(\Gamma \prec \Gamma ^\prime \implies \Gamma ^\prime \prec \Gamma\)</span>.</li>
</ul>
<p>With this additional axiom, one can prove a “weak” form of the entropy principle: that the multiplicative and additive constants in the definition of <span class="math inline">\(S\)</span> for each simple system can be chosen in such a way that <span class="math inline">\(X\prec Y\)</span> implies <span class="math inline">\(S(X) \leq S(Y)\)</span> for any two comparable states (not necessarily of the same system).</p>
<p>The strong form of the entropy principle consists in the statement that all states in connected spaces are comparable, and that adiabatic accessibility is completely characterized by <span class="math inline">\(S\)</span>, in the sense that <span class="math inline">\(X \prec Y\)</span> if and only if <span class="math inline">\(S(X)\leq S(Y)\)</span>. This result depends on a particular assumption (Eq. (6.34) of the reference) that the authors do not axiomatize, but that is subject to experimental verification.</p>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-LY1" class="csl-entry" role="listitem">
Lieb, Elliott H., and Jakob Yngvason. 1999. <span>“The Physics and Mathematics of the Second Law of Thermodynamics.”</span> <em>Physics Reports</em> 310 (1): 1–96. https://doi.org/<a href="https://doi.org/10.1016/S0370-1573(98)00082-9">https://doi.org/10.1016/S0370-1573(98)00082-9</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>In particular, the states <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are always comparable if <span class="math inline">\(\sum _{i=1}^{n} \lambda _i = \sum _{j=1}^m \gamma _j\)</span>. This does not need to be the case if the two sums differ.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>If <span class="math inline">\(t&lt;0\)</span>, we can interpret <span class="math inline">\(X + tY \prec Z\)</span> as <span class="math inline">\(X\prec Z -tY\)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{gherardi2024,
  author = {Gherardi, Valerio},
  title = {“{The} {Physics} and {Mathematics} of the {Second} {Law} of
    {Thermodynamics}” by {E.H.} {Lieb} and {J.} {Yngvason}},
  date = {2024-06-25},
  url = {https://vgherard.github.io/posts/2024-06-25-the-physics-and-mathematics-of-the-second-law-of-thermodynamics-by-eh-lieb-and-j-yngvason/lieb-yngvason-second-law.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-gherardi2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Gherardi, Valerio. 2024. <span>“<span>‘The Physics and Mathematics of
the Second Law of Thermodynamics’</span> by E.H. Lieb and J.
Yngvason.”</span> June 25, 2024. <a href="https://vgherard.github.io/posts/2024-06-25-the-physics-and-mathematics-of-the-second-law-of-thermodynamics-by-eh-lieb-and-j-yngvason/lieb-yngvason-second-law.html">https://vgherard.github.io/posts/2024-06-25-the-physics-and-mathematics-of-the-second-law-of-thermodynamics-by-eh-lieb-and-j-yngvason/lieb-yngvason-second-law.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/vgherard\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="vgherard/vgherard.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkzODI2MzU4NTQ=" data-category="Comments" data-category-id="DIC_kwDOFs6PTs4CbwOw" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>