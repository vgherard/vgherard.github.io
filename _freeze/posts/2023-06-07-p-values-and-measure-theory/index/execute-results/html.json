{
  "hash": "cfdba8ba9edb77dd1bff9c8c9aebaad1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"p-values and measure theory\"\ndescription: |\n  Self-reassurance that p-value properties don't depend on regularity \n  assumptions on the test statistic.\ndate: 2023-06-07\ncategories: \n  - Probability Theory\n  - Measure Theory\n  - Frequentist Methods\n  - Statistics\ndraft: false\n---\n\n\n\n\nLet $(\\Omega, \\mathcal E, \\text{Pr})$ be a probability space, where $\\Omega$ is the space of random outcomes, $\\mathcal E$ the $\\sigma$-algebra of measurable events, and $P$ the probability measure.\n\nGiven a random variable $T\\colon \\Omega \\to \\mathbb R$, define $p_T\\colon \\Omega \\to \\left[0,1\\right]$ as:\n\n$$\np_T(\\omega) = \\text{Pr}(\\{\\omega'\\in \\Omega\\,\\vert\\, T(\\omega')\\geq T(\\omega)\\})\n$$\n\n**Theorem.** $p_T$ is measurable and $\\text{Pr}(p_T\\leq \\alpha) \\leq \\alpha$ for all $\\alpha \\in \\left[0,1\\right]$. Equality holds if and only if there exists a sequence $\\{\\omega_n\\}_{n\\in \\mathbb N}$ such that $p_T(\\omega_n) \\leq \\alpha$, and $p_T(\\omega _n)\\to \\alpha$ as $n \\to \\infty$.\n\n*Proof.* Let $\\alpha\\in\\left[0,1\\right]$, and denote: $$\nE_T(\\omega) = \\{\\omega'\\in \\Omega\\,\\vert\\, T(\\omega')\\geq T(\\omega)\\},\n$$ so that $p_T(\\omega) = \\text{Pr}(E_T(\\omega))$.\n\nAssume first that there exists $\\omega_\\alpha \\in p_T^{-1}(\\alpha)$, that is to say $\\text{Pr}(E_T(\\omega)) = \\alpha$. We can show that:\n\n$$\nN_T(\\omega_\\alpha) = \\{\\omega \\vert p_T(\\omega) \\leq \\alpha\\} \\backslash E_T(\\omega_\\alpha) \n$$ is a measurable, zero probability set, which proves the thesis for this particular case. As a matter of fact, for any $\\omega \\in \\Omega$, if $p_T(\\omega)\\leq \\alpha$ and $T(\\omega) <T(\\omega_\\alpha)$, then we must have:\n\n$$\n\\text{Pr}(\\{\\omega'\\in \\Omega\\,\\vert\\, \n                                                                T(\\omega_\\alpha)>T(\\omega')\\geq T(\\omega)\\}\n                                                                ) = p_T(\\omega) - \\alpha=0.\n$$ If $t_* = \\inf_{p_T(\\omega)\\leq \\alpha}T(\\omega)$ and $\\{a _n\\}_{n \\in \\mathbb N}$ is a sequence in $\\Omega$ such that $T(a _n)\\to t_*$ as $n\\to \\infty$, then:\n\n$$\nN_T(\\omega _\\alpha) \\subseteq \\cup _n \\{\\omega'\\in \\Omega\\,\\vert\\, \n                                                                T(\\omega_\\alpha)>T(\\omega')\\geq T(a_n)\\},\n$$ the right hand side being a probability zero set.\n\nIf $p_T^{-1}(\\alpha)$ is empty, let $\\alpha^* = \\sup _{p_T(\\omega)\\leq \\alpha}p(\\omega)$, and let $\\{b _n\\}_{n\\in \\mathbb N}$ be a sequence in $\\Omega$ such that $p_T(b_n)\\to \\alpha^*$ as $n\\to \\infty$. Then:\n\n$$\n\\{\\omega \\vert p_T(\\omega) \\leq \\alpha\\}=\n\\{\\omega \\vert p_T(\\omega) \\leq \\alpha^*\\}= \n\\cup _n \\{\\omega \\vert p_T(\\omega) \\leq p_T(b_n)\\},\n$$ so that, from the particular case proved earlier, we have:\n\n$$\n\\text{Pr}(p_T \\leq \\alpha) = \\lim _{n \\to \\infty} \\text{Pr}(p_T \\leq p_T(b_n)) \\leq \\lim _{n \\to \\infty} p_T(b_n) = \\alpha ^* \\leq \\alpha,\n$$ as was to be proved.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}